<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Word Cloud Generator</title>
  </head>
  <body>
    <canvas id="wordCloudCanvas" width="500" height="400"></canvas>
    <input type="text" id="wordInput" placeholder="Enter a word" />
    <button id="addWordButton">Add Word</button>

    <script>
      // Function to create a word cloud by placing words on the canvas
      function createWordCloud(words) {
        const wordFrequencies = {};

        // Count word frequencies
        words.forEach((word) => {
          wordFrequencies[word] = (wordFrequencies[word] || 0) + 1;
        });

        const sortedWords = Object.keys(wordFrequencies).sort(
          (a, b) => wordFrequencies[b] - wordFrequencies[a] // Sort words by frequency
        );

        const canvas = document.getElementById('wordCloudCanvas');
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear canvas before drawing new words

        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        let angle = 0;
        let radius = 0;
        const maxRadius = Math.min(centerX, centerY) * 0.8;

        const placedWords = [];

        // Loop through sorted words to place them on canvas
        sortedWords.forEach((word) => {
          const fontSize = 10 + wordFrequencies[word] * 5;
          ctx.font = `${fontSize}px Arial`;
          const textWidth = ctx.measureText(word).width;
          const textHeight = fontSize;

          let placed = false;
          let tries = 0;
          const padding = 5;

          // Attempt to place each word without overlap
          while (!placed && tries < 200) {
            const x = centerX + radius * Math.cos(angle);
            const y = centerY + radius * Math.sin(angle);

            // Check for overlapping with previously placed words
            const isOverlapping = placedWords.some(
              (placedWord) =>
                x < placedWord.x + placedWord.width + padding &&
                x + textWidth + padding > placedWord.x &&
                y < placedWord.y + placedWord.height + padding &&
                y + textHeight + padding > placedWord.y
            );

            // Place word if no overlap and within canvas bounds
            if (
              !isOverlapping &&
              x + textWidth <= canvas.width &&
              x >= 0 &&
              y + textHeight <= canvas.height &&
              y >= 0
            ) {
              ctx.fillStyle = `hsl(${Math.random() * 360}, 100%, 50%)`; // Random color for each word
              ctx.fillText(word, x, y);
              placedWords.push({ x, y, width: textWidth, height: textHeight });
              placed = true;
            }

            // Adjust position and try again if necessary
            angle += 0.3;
            radius = (angle / (2 * Math.PI)) * maxRadius;
            tries++;
          }
        });
      }

      const wordInput = document.getElementById('wordInput');
      const addWordButton = document.getElementById('addWordButton');
      const words = [];

      // Event listener to add word to the list and update the word cloud
      addWordButton.addEventListener('click', () => {
        const word = wordInput.value.trim().toLowerCase();
        if (word) {
          words.push(word);
          wordInput.value = ''; // Clear input field
          createWordCloud(words); // Update word cloud with new word
        }
      });
    </script>
  </body>
</html>
